<!DOCTYPE html>
<html lang="en" class="h-full">
<head>
    <meta charset="UTF-8">
    <title>Imposition UI Test</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #334155;
            padding: 2rem;
        }
        #imposition-modal {
            position: static;
            height: 90vh;
            max-width: 1200px;
            margin: auto;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-[#0f172a] to-[#334155] text-gray-100">

    <div id="imposition-modal" class="fixed inset-0 bg-gray-900 bg-opacity-80 flex items-center justify-center z-50">
        <div class="bg-slate-800 rounded-lg shadow-xl w-full max-w-6xl h-[90vh] mx-4 border border-slate-700/50 flex flex-col">
            <div class="flex justify-between items-center p-4 border-b border-slate-700/50">
                <h3 class="text-xl font-semibold text-white">Manual PDF Imposition</h3>
                <button id="imposition-modal-close-button" class="text-gray-400 hover:text-white text-2xl leading-none">&times;</button>
            </div>
            <div class="flex-1 flex p-4 overflow-hidden">
                <div class="w-1/4 p-4 bg-slate-900/50 rounded-l-md overflow-y-auto">
                    <form id="imposition-form" class="space-y-4">
                        <div>
                            <label for="imposition-type" class="block text-sm font-medium text-gray-300">Imposition Type</label>
                            <select id="imposition-type" name="impositionType" class="mt-1 block w-full rounded-lg border-0 bg-white/5 py-2 px-3 text-white"></select>
                        </div>
                        <div>
                            <label for="sheet-size" class="block text-sm font-medium text-gray-300">Sheet Size</label>
                            <select id="sheet-size" name="sheet" class="mt-1 block w-full rounded-lg border-0 bg-white/5 py-2 px-3 text-white"></select>
                        </div>
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label for="columns" class="block text-sm font-medium text-gray-300">Columns</label>
                                <input type="number" id="columns" name="columns" value="2" min="1" class="mt-1 block w-full rounded-lg border-0 bg-white/5 py-2 px-3 text-white">
                            </div>
                            <div>
                                <label for="rows" class="block text-sm font-medium text-gray-300">Rows</label>
                                <input type="number" id="rows" name="rows" value="2" min="1" class="mt-1 block w-full rounded-lg border-0 bg-white/5 py-2 px-3 text-white">
                            </div>
                        </div>
                    </form>
                </div>
                <div class="w-3/4 bg-black/20 rounded-r-md flex items-center justify-center p-4">
                    <canvas id="imposition-preview-canvas"></canvas>
                </div>
                <div class="w-1/5 bg-slate-900/50 rounded-r-md flex flex-col p-2 space-y-2">
                    <h4 class="text-center font-semibold text-white">Sheet Thumbnails</h4>
                    <div id="imposition-thumbnail-list" class="flex-1 space-y-2 overflow-y-auto p-1"></div>
                </div>
            </div>
        </div>
    </div>

    <script type="module">
        import { initializeImpositionUI } from '../../js/imposition-ui.js';

        // Mock pdfDoc
        const mockPdfDoc = {
            numPages: 8,
            getPage: async function(pageNum) {
                return {
                    getViewport: function({ scale }) {
                        return { width: 595 * scale, height: 842 * scale }; // A4 size
                    },
                    render: function({ canvasContext }) {
                        canvasContext.fillStyle = '#fff';
                        canvasContext.fillRect(0, 0, canvasContext.canvas.width, canvasContext.canvas.height);
                        canvasContext.fillStyle = '#000';
                        canvasContext.font = '30px sans-serif';
                        canvasContext.textAlign = 'center';
                        canvasContext.textBaseline = 'middle';
                        canvasContext.fillText(`Page ${pageNum}`, canvasContext.canvas.width / 2, canvasContext.canvas.height / 2);
                        return { promise: Promise.resolve() };
                    }
                };
            }
        };

        // Mock pdfjsLib
        window.pdfjsLib = {
            GlobalWorkerOptions: { workerSrc: '' },
            getDocument: () => ({ promise: Promise.resolve(mockPdfDoc) })
        };

        // Mock Firestore and project data
        const mockDb = {};
        const mockProjectData = {
            versions: [{ fileURL: 'dummy.pdf' }]
        };

        // Initialize the UI
        initializeImpositionUI({ projectData: mockProjectData, db: mockDb });
    </script>

</body>
</html>