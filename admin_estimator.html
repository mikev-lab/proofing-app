<!DOCTYPE html>
<html lang="en" class="h-full">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MCE Printing - Admin Estimator</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Load Inter font -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Inter', sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        #pdf-viewer {
            position: relative;
            width: 100%;
            height: 100%;
            overflow: hidden;
            cursor: default;
        }
        #pdf-canvas {
             display: block;
        }
        #navigation-controls {
            position: absolute;
            bottom: 1rem;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            align-items: center;
            background-color: rgba(15, 23, 42, 0.8);
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            backdrop-filter: blur(4px);
            z-index: 10;
        }
        /* Style inputs/selects in the specs form */
        #specs-form select,
        #specs-form input[type="number"] {
             margin-top: 0.25rem;
             display: block;
             width: 100%;
             border-radius: 0.5rem; /* rounded-lg */
             border: 0;
             background-color: rgba(255, 255, 255, 0.05); /* bg-white/5 */
             padding-top: 0.5rem; /* py-2 */
             padding-bottom: 0.5rem; /* py-2 */
             padding-left: 0.75rem; /* px-3 */
             padding-right: 0.75rem; /* px-3 */
             color: white; /* text-white */
             box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05); /* shadow-sm */
             ring: 1px solid rgba(255, 255, 255, 0.1); /* ring-1 ring-inset ring-white/10 */
        }
        #specs-form select:focus,
        #specs-form input[type="number"]:focus {
            outline: 2px solid transparent;
            outline-offset: 2px;
            --tw-ring-color: #6366f1; /* focus:ring-indigo-500 */
             box-shadow: 0 0 0 2px #6366f1;
        }
        #specs-form label {
            display: block;
            margin-bottom: 0.25rem;
            font-size: 0.875rem; /* text-sm */
            font-weight: 500; /* font-medium */
            color: #d1d5db; /* text-gray-300 */
        }
        #specs-form .form-group {
            margin-bottom: 1rem; /* Add spacing between groups */
        }
        .accordion-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
        }
    </style>

    <!-- PDF.js Library -->
    <script src="https://mozilla.github.io/pdf.js/build/pdf.mjs" type="module"></script>

    <!-- Chart.js Library -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

</head>
<body class="min-h-screen bg-gradient-to-br from-[#0f172a] to-[#334155] text-gray-100">

    <div class="flex h-full">
        <!-- Sidebar -->
        <div class="flex flex-col w-64 bg-slate-900/70 backdrop-blur-sm border-r border-slate-700/50">
            <div class="flex items-center justify-center h-16 border-b border-slate-700/50">
                <h1 class="text-2xl font-bold text-white">MCE Admin</h1>
            </div>
            <div class="flex-grow">
                <nav class="flex-grow md:block px-4 pb-4 md:pb-0 md:overflow-y-auto">
                    <a class="block px-4 py-2 mt-2 text-sm font-semibold text-gray-200 bg-slate-700/50 rounded-lg hover:bg-slate-600/50" href="admin.html">All Projects</a>
                    <a class="block px-4 py-2 mt-2 text-sm font-semibold text-gray-300 rounded-lg hover:bg-slate-700/50" href="admin_client_management.html">Clients</a>
                    <a href="admin_inventory.html" class="block px-4 py-2 mt-2 text-sm font-semibold text-gray-300 rounded-lg hover:bg-slate-700/50">Inventory</a>
                    <a class="block px-4 py-2 mt-2 text-sm font-semibold text-gray-300 rounded-lg hover:bg-slate-700/50" href="admin_settings.html">Settings</a>
                </nav>
            </div>
        </div>

        <!-- Main content -->
        <div class="flex flex-col flex-1">
            <!-- Header -->
            <header class="flex justify-between items-center h-16 px-6 bg-slate-800/60 backdrop-blur-sm border-b border-slate-700/50">
                <div>
                    <h2 class="text-xl font-semibold text-white">Admin Job Estimator</h2>
                </div>
                <div class="flex items-center space-x-4">
                    <span id="user-email" class="text-sm text-gray-300 hidden sm:block"></span>
                    <button id="logout-button" class="bg-indigo-600 hover:bg-indigo-500 text-white font-semibold py-2 px-4 rounded-md text-sm transition-all duration-150 ease-in-out">
                        Sign Out
                    </button>
                </div>
            </header>

            <main class="flex-1 p-6">
                <div class="grid grid-cols-1 xl:grid-cols-3 gap-6">
                    <!-- Left Column: Form -->
                    <div class="xl:col-span-1 bg-slate-800/60 rounded-lg shadow-xl border border-slate-700/50">
                        <form id="estimator-form" class="p-6 space-y-6">
                            <!-- Job Specs -->
                            <div>
                                <h3 class="text-lg font-semibold text-white border-b border-slate-700/50 pb-2 mb-4">Job Specifications</h3>
                                <div class="space-y-4">
                                    <div>
                                        <label for="bookTitle" class="block text-sm font-medium text-gray-300">Book Title</label>
                                        <input type="text" id="bookTitle" name="bookTitle" class="mt-1 block w-full rounded-lg border-0 bg-white/5 py-2 px-3 text-white">
                                    </div>
                                    <div class="grid grid-cols-3 gap-4">
                                        <div>
                                            <label for="quantity" class="block text-sm font-medium text-gray-300">Quantity</label>
                                            <input type="number" id="quantity" name="quantity" value="100" class="mt-1 block w-full rounded-lg border-0 bg-white/5 py-2 px-3 text-white">
                                        </div>
                                        <div>
                                            <label for="finishedWidth" class="block text-sm font-medium text-gray-300">Width (in)</label>
                                            <input type="number" id="finishedWidth" name="finishedWidth" value="5.5" step="0.1" class="mt-1 block w-full rounded-lg border-0 bg-white/5 py-2 px-3 text-white">
                                        </div>
                                        <div>
                                            <label for="finishedHeight" class="block text-sm font-medium text-gray-300">Height (in)</label>
                                            <input type="number" id="finishedHeight" name="finishedHeight" value="8.5" step="0.1" class="mt-1 block w-full rounded-lg border-0 bg-white/5 py-2 px-3 text-white">
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Interior -->
                            <div>
                                <h3 class="text-lg font-semibold text-white border-b border-slate-700/50 pb-2 mb-4">Interior Pages</h3>
                                <div class="grid grid-cols-2 gap-4">
                                    <div>
                                        <label for="bwPages" class="block text-sm font-medium text-gray-300">B&W Pages</label>
                                        <input type="number" id="bwPages" name="bwPages" value="20" class="mt-1 block w-full rounded-lg border-0 bg-white/5 py-2 px-3 text-white">
                                    </div>
                                    <div>
                                        <label for="bwPaperSku" class="block text-sm font-medium text-gray-300">B&W Paper</label>
                                        <select id="bwPaperSku" name="bwPaperSku" class="mt-1 block w-full rounded-lg border-0 bg-white/5 py-2 px-3 text-white"></select>
                                    </div>
                                    <div>
                                        <label for="colorPages" class="block text-sm font-medium text-gray-300">Color Pages</label>
                                        <input type="number" id="colorPages" name="colorPages" value="0" class="mt-1 block w-full rounded-lg border-0 bg-white/5 py-2 px-3 text-white">
                                    </div>
                                    <div>
                                        <label for="colorPaperSku" class="block text-sm font-medium text-gray-300">Color Paper</label>
                                        <select id="colorPaperSku" name="colorPaperSku" class="mt-1 block w-full rounded-lg border-0 bg-white/5 py-2 px-3 text-white"></select>
                                    </div>
                                </div>
                            </div>

                            <!-- Cover -->
                            <div>
                                <h3 class="text-lg font-semibold text-white border-b border-slate-700/50 pb-2 mb-4">Cover</h3>
                                <div class="space-y-4">
                                     <label class="flex items-center space-x-3 cursor-pointer">
                                        <input type="checkbox" id="hasCover" name="hasCover" checked class="h-5 w-5 rounded border-gray-400 text-indigo-500 bg-slate-700 focus:ring-indigo-600">
                                        <span class="text-gray-200">Has Cover</span>
                                    </label>
                                    <div>
                                        <label for="coverPaperSku" class="block text-sm font-medium text-gray-300">Cover Paper</label>
                                        <select id="coverPaperSku" name="coverPaperSku" class="mt-1 block w-full rounded-lg border-0 bg-white/5 py-2 px-3 text-white"></select>
                                    </div>
                                    <div class="grid grid-cols-2 gap-4">
                                        <div>
                                            <label for="coverPrintColor" class="block text-sm font-medium text-gray-300">Print Color</label>
                                            <select id="coverPrintColor" name="coverPrintColor" class="mt-1 block w-full rounded-lg border-0 bg-white/5 py-2 px-3 text-white">
                                                <option value="COLOR">Color</option>
                                                <option value="BW">Black & White</option>
                                            </select>
                                        </div>
                                         <div>
                                            <label class="flex items-center space-x-3 cursor-pointer pt-8">
                                                <input type="checkbox" id="coverPrintsOnBothSides" name="coverPrintsOnBothSides" class="h-5 w-5 rounded border-gray-400 text-indigo-500 bg-slate-700 focus:ring-indigo-600">
                                                <span class="text-gray-200">Prints on Both Sides</span>
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Finishing -->
                            <div>
                                <h3 class="text-lg font-semibold text-white border-b border-slate-700/50 pb-2 mb-4">Finishing & Binding</h3>
                                <div class="grid grid-cols-2 gap-4">
                                    <div>
                                        <label for="bindingMethod" class="block text-sm font-medium text-gray-300">Binding</label>
                                        <select id="bindingMethod" name="bindingMethod" class="mt-1 block w-full rounded-lg border-0 bg-white/5 py-2 px-3 text-white">
                                            <option value="perfectBound">Perfect Bound</option>
                                            <option value="saddleStitch">Saddle Stitch</option>
                                            <option value="none">Loose Leaf</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label for="laminationType" class="block text-sm font-medium text-gray-300">Lamination</label>
                                        <select id="laminationType" name="laminationType" class="mt-1 block w-full rounded-lg border-0 bg-white/5 py-2 px-3 text-white">
                                            <option value="gloss">Gloss</option>
                                            <option value="matte">Matte</option>
                                            <option value="none">None</option>
                                        </select>
                                    </div>
                                </div>
                            </div>

                            <!-- Shipping -->
                            <div>
                                <h3 class="text-lg font-semibold text-white border-b border-slate-700/50 pb-2 mb-4">Shipping</h3>
                                 <label class="flex items-center space-x-3 cursor-pointer">
                                    <input type="checkbox" id="calculateShipping" name="calculateShipping" checked class="h-5 w-5 rounded border-gray-400 text-indigo-500 bg-slate-700 focus:ring-indigo-600">
                                    <span class="text-gray-200">Calculate Shipping</span>
                                </label>
                                 <div class="mt-4">
                                    <label for="overrideShippingBoxName" class="block text-sm font-medium text-gray-300">Shipping Box (Override)</label>
                                    <select id="overrideShippingBoxName" name="overrideShippingBoxName" class="mt-1 block w-full rounded-lg border-0 bg-white/5 py-2 px-3 text-white">
                                         <option value="">Automatic</option>
                                         <!-- Add other box options if needed later -->
                                    </select>
                                </div>
                            </div>

                            <!-- Admin Pricing -->
                            <div>
                                <h3 class="text-lg font-semibold text-white border-b border-slate-700/50 pb-2 mb-4">Admin Pricing</h3>
                                <div class="grid grid-cols-3 gap-4">
                                    <div>
                                        <label for="laborRate" class="block text-sm font-medium text-gray-300">Labor Rate ($/hr)</label>
                                        <input type="number" id="laborRate" name="laborRate" class="mt-1 block w-full rounded-lg border-0 bg-white/5 py-2 px-3 text-white">
                                    </div>
                                    <div>
                                        <label for="markupPercent" class="block text-sm font-medium text-gray-300">Markup (%)</label>
                                        <input type="number" id="markupPercent" name="markupPercent" class="mt-1 block w-full rounded-lg border-0 bg-white/5 py-2 px-3 text-white">
                                    </div>
                                    <div>
                                        <label for="spoilagePercent" class="block text-sm font-medium text-gray-300">Spoilage (%)</label>
                                        <input type="number" id="spoilagePercent" name="spoilagePercent" class="mt-1 block w-full rounded-lg border-0 bg-white/5 py-2 px-3 text-white">
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>

                    <!-- Right Column: Results -->
                    <div class="xl:col-span-2 space-y-6">
                        <!-- Cost Summary -->
                        <div class="bg-slate-800/60 rounded-lg shadow-xl border border-slate-700/50 p-6">
                            <h3 class="text-lg font-semibold text-white border-b border-slate-700/50 pb-2 mb-4">Cost Summary</h3>
                            <div id="cost-summary-container" class="space-y-2 text-sm">
                                <!-- Summary will be populated here -->
                                <p class="text-gray-400">Enter job details to see the cost breakdown.</p>
                            </div>
                        </div>

                        <!-- Quantity Analysis -->
                        <div class="bg-slate-800/60 rounded-lg shadow-xl border border-slate-700/50 p-6">
                            <h3 class="text-lg font-semibold text-white border-b border-slate-700/50 pb-2 mb-4">Quantity Analysis</h3>
                            <div class="h-96">
                                <canvas id="quantity-analysis-chart"></canvas>
                            </div>
                             <div id="analysis-summary-container" class="mt-6">
                                <!-- Analysis table will go here -->
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <script type="module" src="js/admin_estimator.js"></script>
</body>
</html>
